<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Project Downloads</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Single page with downloadable project resources." />
  <style>
    :root {
      --bg:#1a1f2e; --panel:#242936; --accent:#4a9eff; --accent-hover:#3d8ae6;
      --text:#f0f3f7; --sub:#a8b3c1; --radius:8px; --mono:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    }
    * { box-sizing: border-box; }
    body { margin:0; font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif; background:var(--bg); color:var(--text); }
    header { padding:2.5rem 1.25rem 1rem; text-align:center; }
    h1 { margin:0 0 .5rem; font-size:2.2rem; }
    p.lead { margin:.25rem 0 0; color:var(--sub); }
    main { max-width:880px; margin:0 auto; padding:0 1.25rem 3rem; }
    section { background:var(--panel); padding:1.5rem 1.25rem 1.75rem; border-radius:var(--radius); margin-bottom:1.5rem; }
    h2 { margin:0 0 1rem; font-size:1.2rem; letter-spacing:.5px; text-transform:uppercase; color:var(--sub); }
    ul.files { list-style:none; margin:0; padding:0; }
    ul.files li { display:flex; flex-wrap:wrap; align-items:center; gap:.75rem; padding:.85rem 1rem; border:1px solid #353b4a; border-radius:6px; background:#2a3040; margin-bottom:.75rem; }
    ul.files li:hover { border-color:#424856; }
    .fname { font-weight:600; }
    .meta { color:var(--sub); font-size:.8rem; font-family:var(--mono); }
    a.dl-btn {
      margin-left:auto; text-decoration:none; background:var(--accent); color:#fff;
      padding:.55rem .95rem; border-radius:5px; font-size:.85rem; font-weight:600;
      display:inline-flex; align-items:center; gap:.35rem;
    }
    a.dl-btn:hover { background:var(--accent-hover); }
    code { font-family:var(--mono); font-size:.85rem; background:#2a3040; padding:.15rem .35rem; border-radius:4px; }
    footer { text-align:center; padding:2rem 1rem 3rem; color:var(--sub); font-size:.8rem; }
    .badges { display:flex; flex-wrap:wrap; gap:.5rem; margin-top:.75rem; }
    .badge { background:#2a3040; padding:.3rem .6rem; border-radius:20px; font-size:.7rem; letter-spacing:.5px; text-transform:uppercase; color:var(--sub); }
    .anim-grid { display:grid; gap:1rem; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); }
    .anim-card { background:var(--panel); border:1px solid #353b4a; border-radius:var(--radius); padding:0.85rem 0.85rem 1rem; display:flex; flex-direction:column; gap:.55rem; }
    .anim-card h3 { margin:0; font-size:.9rem; line-height:1.2; }
    .anim-card p { margin:0; font-size:.7rem; color:var(--sub); }
    .anim-card video { width:100%; aspect-ratio:16/9; background:#000; border-radius:6px; display:block; }
    .anim-card footer { margin-top:auto; }
    @media (max-width:520px){
      ul.files li { flex-direction:column; align-items:flex-start; }
      a.dl-btn { width:100%; justify-content:center; margin-left:0; }
    }
    p.lead { margin:.25rem 0 0; color:var(--sub); }
    p.lead a { color:#6db3ff; text-decoration:none; }
    p.lead a:hover { text-decoration:underline; }
    main { max-width:880px; margin:0 auto; padding:0 1.25rem 3rem; }
  </style>
</head>
<body>
  <header>
    <h1>Global Optimality for Shallow Neural Networks</h1>
    <p class="lead">
      Animations accompanying this <a href="https://cleeuw.github.io/files/Global Optimality for Shallow Neural Networks.pdf">master's thesis</a>. Produced using <a href="https://github.com/cleeuw/nn-train-code">nn-train-code</a>.
    </p>
    <div class="badges">
      <span class="badge">Updated <span id="build-date"></span></span>
    </div>
  </header>

  <main>
    <!-- geluex -->
    <section aria-labelledby="animations-h">
      <h2 id="animations-h">Animations for Figures 4.4, 4.5 and 4.6</h2>
      <p style="margin:.75rem 0 1rem; color:var(--sub); font-size:.85rem;">
        The training process of a mean-field network on 30 data points generated by <em>f</em>(<em>x</em>) = sin(2π<em>x</em>) + 2, with <em>m</em> = 1000, <em>σ</em> = GELU, <em>λ</em> = 10<sup>−5</sup>, <em>c</em><sub>B</sub> = 1, and <em>α</em> = <em>m</em> · 0.01 = 10.
      </p>
      <div id="animation-grid" class="anim-grid"></div>
    </section>

    <!-- lrelu-escape -->
    <section aria-labelledby="animations2-h">
      <h2 id="animations2-h">Animations for Figure 5.1</h2>
      <p style="margin:.75rem 0 1rem; color:var(--sub); font-size:.85rem;">
        The training process of a (standard) network on 3 data points, with <em>m</em> = 1000, <em>σ</em> = LReLU_{0.1}, <em>λ</em> = 10<sup>−5</sup>, <em>c</em><sub>B</sub> = 1, and <em>α</em> = 0.01.
      </p>
      <div id="animations2-grid" class="anim-grid"></div>
    </section>

    <!-- lossomnidir -->
    <section aria-labelledby="animations3-h">
      <h2 id="animations3-h">Animations for Figure 5.3</h2>
      <p style="margin:.75rem 0 1rem; color:var(--sub); font-size:.85rem;">
        The training process of a (standard) network on 3 data points, with <em>m</em> = 2.5 · 10<sup>5</sup>, <em>σ</em> = ReLU, <em>λ</em> = 10<sup>−5</sup>, <em>c</em><sub>B</sub> = 1, and <em>α</em> = 0.01.
      </p>
      <div id="animations3-grid" class="anim-grid"></div>
    </section>

    <!-- EA-OLS -->
    <section aria-labelledby="animations4-h">
      <h2 id="animations4-h">Animation for Figures 6.1 and 6.2</h2>
      <p style="margin:.75rem 0 1rem; color:var(--sub); font-size:.85rem;">
        The training process of a (standard) network on 3 data points, with <em>m</em> = 1000, <em>σ</em> = ReLU, <em>λ</em> = 10<sup>−5</sup>, <em>c</em><sub>B</sub> = 1, and <em>α</em> = 0.01.
      </p>
      <div id="animations4-grid" class="anim-grid"></div>
    </section>
  </main>

  <footer>
    Hosted on GitHub Pages • <a href="https://github.com/cleeuw/nn-visualization" style="color:var(--accent); text-decoration:none;">Repository</a>
  </footer>

  <script>
    // Animation configuration
    const animations = [
      {
        src: 'animations/c4/geluex;anim;0-1000-150000,T,noth,0,F,T,F,T,F;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 0-150000',
        description: 'This animation shows the entire training process from start to finish, with a variable scale for <em>G</em>. The other animations provide a more detailed view of specific training phases.'
      },
      {
        src: 'animations/c4/geluex;anim;0-200,T,0,0,F,T,F,T,T;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 0-200',
        description: ''
      },
      {
        src: 'animations/c4/geluex;anim;200-10-500,T,0,0,F,T,F,T,T;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 200-500',
        description: ''
      },
      {
        src: 'animations/c4/geluex;anim;500-10-1000,T,noth,0,F,T,F,T,F;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 500-1000',
        description: ''
      },
      {
        src: 'animations/c4/geluex;anim;1000-200-55000,T,0,0,F,T,F,T,F;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 1000-55000',
        description: ''
      },
      {
        src: 'animations/c4/geluex;anim;55000-200-70000,T,noth,0,F,T,F,T,F;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 55000-70000',
        description: ''
      },
      {
        src: 'animations/c4/geluex;anim;70000-500-100000,T,0,0,F,T,F,T,F;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 70000-100000',
        description: ''
      },
      {
        src: 'animations/c4/geluex;anim;100000-1000-150000,T,noth,0,F,T,F,T,F;m=1000;cB=1.0;lam=1e-5;act=gelu;T=F64;MF=T;rep=F;n=30;lrn=10.0;opt=GD.mp4',
        title: 'Epochs 100000-150000',
        description: ''
      },
    ];

    const animations2 = [
      {
        src: 'animations/c5/lrelu-escape;anim;0-10-1000,F,0,noth,F,T,T,T,F;m=1000;cB=1.0;lam=1e-5;act=leakyrelu(0.1);T=F64;MF=F;rep=F;n=3;lrn=0.01;opt=GD.mp4',
        title: 'Epochs 0-1000',
        description: ''
      },
      {
        src: 'animations/c5/lrelu-escape;anim;1000-100-40000,F,0,noth,F,T,T,T,F;m=1000;cB=1.0;lam=1e-5;act=leakyrelu(0.1);T=F64;MF=F;rep=F;n=3;lrn=0.01;opt=GD.mp4',
        title: 'Epochs 1000-40000',
        description: ''
      },
    ];

    const animations3 = [
      {
        src: 'animations/c5/lossomnidir;anim;0-100,T,0,0,F,T,T,T,T;m=250000;cB=1.0;lam=1e-5;act=relu;T=F64;MF=F;rep=F;n=3;lrn=0.01;opt=GD.mp4',
        title: 'Epochs 0-100, polar',
        description: ''
      },
      {
        src: 'animations/c5/lossomnidir;anim;0-100,F,0,0,F,T,T,T,F;m=250000;cB=1.0;lam=1e-5;act=relu;T=F64;MF=F;rep=F;n=3;lrn=0.01;opt=GD.mp4',
        title: 'Epochs 0-100, angle-radius',
        description: ''
      },
    ];

    const animations4 = [
      {
        src: 'animations/c6/EA-OLS;anim;[0-10-999;1000-100-4999;5000-1000-25000],F,0,noth,F,T,T,T,F;m=1000;cB=1.0;lam=1e-5;act=relu;T=F64;MF=F;rep=F;n=3;lrn=0.01;opt=GD.mp4',
        title: 'Epochs 0-25000',
        description: 'Note: the epoch rate speeds up at epoch 1000 and again at epoch 5000'
      },
    ];

    // Render animations
    (function renderAnimations(){
      const sections = [
        { gridId: 'animation-grid', data: animations },
        { gridId: 'animations2-grid', data: animations2 },
        { gridId: 'animations3-grid', data: animations3 },
        { gridId: 'animations4-grid', data: animations4 }
      ];

      sections.forEach(section => {
        const host = document.getElementById(section.gridId);
        section.data.forEach(a => {
          const card = document.createElement('article');
          card.className = 'anim-card';
          card.innerHTML = `
            <video controls playsinline preload="metadata" src="${a.src}" title="${a.title}" muted></video>
            <h3>${a.title}</h3>
            <p>${a.description}</p>
            <footer>
              <a href="${a.src}" download style="color:var(--accent); font-size:.65rem; text-decoration:none;">Download MP4</a>
            </footer>
          `;
          host.appendChild(card);
        });
      });
    })();

    // Build date
    document.getElementById('build-date').textContent = new Date().toISOString().slice(0,10);
  </script>
</body>
</html>